27.01.2026 
(si vede la finestra, la linea scorre, adesso bisogna iniziare a disegnare la griglia e le tracce, ho dato anche qualche linea
guida per quello che riguarda l'architettura delle delle scene, possiilita' di inserire/ cancellare tracce,
inserire anche scale ritmiche diverse etc.)

1Ô∏è‚É£ Griglia generale

- La griglia non deve avere un numero fisso di righe o colonne.
- Le **righe orizzontali** dipendono dal numero di tracce presenti nella scena.
- Le **colonne verticali** dipendono dalla scala ritmica / metrica di ogni traccia.
- Ogni traccia pu√≤ avere una metrica diversa (es. Track 1: 4/4, Track 2: 6/8).
- La griglia √® **una vista**, non il modello musicale.

---

2Ô∏è‚É£ Principio fondamentale

- La scena rappresenta un **contenitore temporale**.
- La griglia grafica √® una **proiezione del tempo e delle tracce**, non deve definire la struttura.
- Tempo musicale e pixel dello schermo sono concetti separati.

---

3Ô∏è‚É£ Struttura Scene / Track

- Scene:
    - `lengthTicks` ‚Üí durata totale della scena in tick.
    - `ppq` ‚Üí risoluzione temporale (Pulses Per Quarter note).
    - `tracks` ‚Üí vettore di tracce.
- Track:
    - `TimeSignature signature` ‚Üí es. 4/4, 6/8.
    - `gridSubdivision` ‚Üí numero di suddivisioni della battuta per il disegno della griglia.

---

4Ô∏è‚É£ Coordinata X (tempo ‚Üí pixel)

- Formula chiave:
    pixelX = (tick / scene.lengthTicks) * width
- Ogni traccia pu√≤ avere:
    - Linee forti = inizio battuta
    - Linee medie = beat
    - Linee deboli = suddivisioni
- Cos√¨ si possono sovrapporre tracce con metriche diverse, creando poliritmie visive.

---

5Ô∏è‚É£ Coordinata Y (tracce ‚Üí pixel)

- `trackHeight = height / scene.tracks.size()`
- Ogni traccia ha una **banda orizzontale**.
- Possibile aggiungere sottorighe per pitch, drum lane, automazioni, ecc.

---

6Ô∏è‚É£ Disegno griglia

- Verticale:
    - Dipende dai tick e dalla metrica della traccia, non dallo schermo.
    - Disegnata per ogni traccia separatamente.
- Orizzontale:
    - Dipende dal numero di tracce presenti.
    - Divide lo spazio verticale tra le tracce.
- Linee sottili = suddivisioni, linee pi√π spesse = beat, linee pi√π forti = inizio battuta.

---

7Ô∏è‚É£ Gestione note e snapping

- Mouse ‚Üí pixel ‚Üí tempo ‚Üí tick
- Mouse ‚Üí pixelY ‚Üí traccia
- Snap delle note alle intersezioni della griglia.
- Le note vengono registrate in coordinate **musicali (tick / traccia / pitch)**, non pixel.

---

8Ô∏è‚É£ Fullscreen e rendering

- Fullscreen:
    - Salvare dimensioni finestra prima di entrare in fullscreen (`windowedWidth` / `windowedHeight`).
    - Ripristinare le dimensioni quando si esce dal fullscreen.
    - Aggiornare sempre `width` / `height` usate per il rendering.
- Cursor / griglia / note devono scalare in base a `width` / `height`.

---

9Ô∏è‚É£ Concetti chiave DAW-style

- La scena √® **tempo assoluto**, indipendente dalla metrica delle tracce.
- Ogni traccia interpreta il tempo secondo la sua **signature**.
- La griglia √® sempre una **vista derivata** dal modello musicale.
- Permette poliritmie, sovrapposizioni metriche e suddivisioni variabili.

---

üîπ Prossimi passi consigliati

1. Aggiungere a `Scene`:
    - `lengthTicks`
    - `ppq`
2. Aggiungere a `Track`:
    - `TimeSignature`
    - `gridSubdivision`
3. Scrivere funzione `timeToPixel(tick)` per mappare tick ‚Üí pixelX.
4. Disegnare la griglia **per traccia**, rispettando le metriche.
5. Implementare mouse ‚Üí tick ‚Üí snap note.
6. Eventuale gestione note + pitch ‚Üí pixelY.

